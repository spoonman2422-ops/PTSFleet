
{
  "entities": {
    "Message": {
      "title": "Message",
      "description": "A message sent between a driver and a dispatcher.",
      "type": "object",
      "properties": {
        "text": {
          "type": "string",
          "description": "The content of the message."
        },
        "senderId": {
          "type": "string",
          "description": "The ID of the user who sent the message."
        },
        "senderName": {
          "type": "string",
          "description": "The name of the user who sent the message."
        },
        "bookingId": {
          "type": "string",
          "description": "The ID of the booking this message relates to."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The time the message was sent."
        },
        "imageUrl": {
          "type": "string",
          "format": "uri",
          "description": "An optional URL to an image attached to the message."
        }
      },
      "required": ["senderId", "senderName", "bookingId", "createdAt"]
    },
    "Booking": {
      "title": "Booking",
      "description": "A booking for a transport job.",
      "type": "object",
      "properties": {
        "clientId": { "type": "string" },
        "driverId": { "type": "string" },
        "pickupLocation": { "type": "string" },
        "dropoffLocation": { "type": "string" },
        "bookingDate": { "type": "string", "format": "date" },
        "billingDate": { "type": "string", "format": "date" },
        "completionDate": { "type": "string", "format": "date" },
        "dueDate": { "type": "string", "format": "date" },
        "grossBookingRate": { "type": "number" },
        "bookingRate": { "type": "number" },
        "ewtApplied": { "type": "boolean" },
        "driverRate": { "type": "number" },
        "vehicleType": { "type": "string", "enum": ["6-Wheel", "AUV"] },
        "expectedExpenses": {
          "type": "object",
          "properties": {
            "tollFee": { "type": "number" },
            "fuel": { "type": "number" },
            "others": { "type": ["number", "null"] }
          }
        },
        "status": { "type": "string", "enum": ["pending", "in-progress", "completed", "cancelled"] },
        "proofOfDeliveryUrl": { "type": "string", "format": "uri" }
      },
      "required": ["clientId", "pickupLocation", "dropoffLocation", "bookingDate", "status", "bookingRate", "grossBookingRate", "ewtApplied", "vehicleType"]
    },
    "UserProfile": {
        "title": "User Profile",
        "description": "Stores public information about a user.",
        "type": "object",
        "properties": {
            "name": { "type": "string" },
            "email": { "type": "string", "format": "email" },
            "role": { "type": "string", "enum": ["Admin", "Dispatcher", "Driver"] },
            "avatarUrl": { "type": "string", "format": "uri" },
            "vehicleId": { "type": ["string", "null"], "description": "The ID of the vehicle assigned to this user, if they are a driver." }
        },
        "required": ["name", "email", "role"]
    },
    "Invoice": {
      "title": "Invoice",
      "description": "An invoice for a transport job with tax calculations.",
      "type": "object",
      "properties": {
        "clientId": { "type": "string" },
        "bookingId": { "type": "string" },
        "grossSales": { "type": "number" },
        "vatRegistered": { "type": "boolean" },
        "vatRate": { "type": "number" },
        "vatAmount": { "type": "number" },
        "percentageTaxRate": { "type": "number" },
        "percentageTaxAmount": { "type": "number" },
        "incomeTaxOption": { "type": "string", "enum": ["8_percent_flat", "graduated"] },
        "incomeTaxAmount": { "type": "number" },
        "netRevenue": { "type": "number" },
        "dateIssued": { "type": "string", "format": "date-time" },
        "dueDate": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["Paid", "Unpaid", "Overdue"] },
        "proofOfBillingUrl": { "type": "string", "format": "uri" }
      },
      "required": ["clientId", "bookingId", "grossSales", "dateIssued", "dueDate", "status"]
    },
    "Expense": {
      "title": "Expense",
      "description": "A record of a business expense with VAT details.",
      "type": "object",
      "properties": {
        "bookingId": {
          "type": "string",
          "description": "The ID of the booking this expense relates to (if applicable)."
        },
        "category": {
          "type": "string",
          "description": "The category of the expense.",
          "enum": ["fuel", "maintenance", "toll", "office", "staff", "permits", "vehicle parts", "pms", "change oil", "client representation", "driver rate", "miscellaneous", "Vehicle Related Expense", "driver payroll"]
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the expense."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the expense."
        },
        "vatIncluded": { "type": "boolean" },
        "vatRate": { "type": "number" },
        "inputVat": { "type": "number" },
        "dateIncurred": {
          "type": "string",
          "format": "date",
          "description": "The date the expense was incurred."
        },
        "paidBy": {
          "type": "string",
          "description": "The payment method used for the expense.",
          "enum": ["cash", "bank", "credit", "PTS"]
        },
        "addedBy": {
          "type": "string",
          "description": "The ID of the user who logged this expense."
        },
        "notes": {
          "type": "string",
          "description": "Optional notes about the expense."
        }
      },
      "required": ["category", "description", "amount", "dateIncurred", "paidBy", "addedBy"]
    },
    "RevolvingFundContribution": {
      "title": "Revolving Fund Contribution",
      "description": "A record of a contribution to the company's revolving fund by an owner.",
      "type": "object",
      "properties": {
        "contributorName": {
          "type": "string",
          "description": "The name of the owner making the contribution."
        },
        "amount": {
          "type": "number",
          "description": "The amount contributed."
        },
        "contributionDate": {
          "type": "string",
          "format": "date",
          "description": "The date the contribution was made."
        },
        "addedBy": {
          "type": "string",
          "description": "The ID of the admin who logged this contribution."
        }
      },
      "required": ["contributorName", "amount", "contributionDate", "addedBy"]
    },
    "CashAdvance": {
      "title": "Cash Advance",
      "description": "A record of a cash advance given to a driver.",
      "type": "object",
      "properties": {
        "driverId": {
          "type": "string",
          "description": "The ID of the driver receiving the advance."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the cash advance."
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "The date the advance was given."
        },
        "addedBy": {
          "type": "string",
          "description": "The ID of the admin who logged this advance."
        }
      },
      "required": ["driverId", "amount", "date", "addedBy"]
    },
    "Vehicle": {
      "title": "Vehicle",
      "description": "A company vehicle.",
      "type": "object",
      "properties": {
        "make": { "type": "string", "description": "The manufacturer of the vehicle (e.g., Isuzu)." },
        "model": { "type": "string", "description": "The model of the vehicle (e.g., N-Series)." },
        "year": { "type": "number", "description": "The manufacturing year." },
        "plateNumber": { "type": "string", "description": "The unique license plate number." },
        "vin": { "type": "string", "description": "The unique Vehicle Identification Number." },
        "ownerName": { "type": "string", "description": "The legal owner of the vehicle." },
        "dateAcquired": { "type": "string", "format": "date", "description": "The date the vehicle was purchased." },
        "nextMaintenanceDate": { "type": "string", "format": "date", "description": "The date for the next scheduled maintenance." },
        "amortizationSchedule": { "type": "string", "description": "The recurring day of the month for amortization payment (e.g., 'Every 15th')." },
        "amortizationEndDate": { "type": "string", "format": "date", "description": "The end date for the vehicle's amortization or lease." },
        "status": { "type": "string", "enum": ["Active", "Under Maintenance", "Decommissioned"], "description": "The current operational status of the vehicle." }
      },
      "required": ["make", "model", "year", "plateNumber", "ownerName", "dateAcquired", "status"]
    }
  },
  "auth": {
    "providers": ["anonymous"]
  },
  "firestore": {
    "/bookings/{bookingId}/messages/{messageId}": {
      "schema": {
        "$ref": "#/entities/Message"
      },
      "description": "Messages for a specific booking."
    },
    "/bookings/{bookingId}": {
      "schema": {
        "$ref": "#/entities/Booking"
      },
      "description": "A collection of all bookings."
    },
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "A collection of all user profiles."
    },
    "/invoices/{invoiceId}": {
      "schema": {
        "$ref": "#/entities/Invoice"
      },
      "description": "A collection of all invoices."
    },
    "/expenses/{expenseId}": {
      "schema": {
        "$ref": "#/entities/Expense"
      },
      "description": "A collection of all business expenses."
    },
    "/revolvingFundContributions/{contributionId}": {
      "schema": {
        "$ref": "#/entities/RevolvingFundContribution"
      },
      "description": "A collection of all revolving fund contributions from owners."
    },
    "/cashAdvances/{caId}": {
      "schema": {
        "$ref": "#/entities/CashAdvance"
      },
      "description": "A collection of all cash advances given to drivers."
    },
     "/vehicles/{vehicleId}": {
      "schema": {
        "$ref": "#/entities/Vehicle"
      },
      "description": "A collection of all company vehicles."
    }
  }
}
